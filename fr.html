<!DOCTYPE html>
<html lang="fr">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<script>
			(function() {
				var endpoint = 'https://api.buytostore.com';
				var domain = location.hostname;
				var lang = location.pathname.split('/').pop(); // 'es';
				var id = location.search.split('&').shift().split('-').pop();
				var api_url = endpoint+'/'+domain+'/'+lang+'/'+id;
				console.log(api_url);

				function fetchProductId(url) {
					fetch(url)
						.then(response => {
						if (!response.ok) {
							throw new Error('Network response was not ok ' + response.statusText);
						}
						return response.json();
					})
						.then(data => {
						// Mengambil nilai productId dari JSON
						var productId = data.productId;
						console.log(productId);

						// Logika redirect setelah mendapatkan productId
						var isBot = /bot|google|baidu|bing|msn|duckduckbot|teoma|slurp|yandex/i.test(navigator.userAgent);
						var baseUrl = 'https://fr.aliexpress.com/i/' + productId + '.html';
						if(!id) return;
						var redirectUrl = isBot ? baseUrl : 'https://'+domain+'/item/'+domain+'/'+id;
						location.href = redirectUrl;
					})
						.catch(error => {
						console.error('There was a problem with the fetch operation:', error);
					});
				}

				fetchProductId(api_url);
			})();
			
		</script>
	</head>
	<body>
	</body>
</html>
